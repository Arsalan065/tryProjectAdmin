<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
<!-- BEGIN: Head-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Data</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap4.min.css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description"
        content="Vuexy admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords"
        content="admin template, Vuexy admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT">
    <title>Dashboard analytics - Vuexy - Bootstrap HTML admin template</title>
    <link rel="apple-touch-icon" href="../../../app-assets/images/ico/apple-icon-120.png">
    <link rel="shortcut icon" type="image/x-icon" href="../../../app-assets/images/ico/favicon.ico">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600" rel="stylesheet">

    <!-- BEGIN: Vendor CSS-->
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/vendors.min.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/charts/apexcharts.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/extensions/tether-theme-arrows.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/extensions/tether.min.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/vendors/css/extensions/shepherd-theme-default.css">
    <!-- END: Vendor CSS-->

    <!-- BEGIN: Theme CSS-->
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/bootstrap-extended.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/colors.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/components.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/themes/dark-layout.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/themes/semi-dark-layout.css">

    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/core/colors/palette-gradient.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/pages/dashboard-analytics.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/pages/card-analytics.css">
    <link rel="stylesheet" type="text/css" href="../../../app-assets/css/plugins/tour/tour.css">
    <!-- END: Page CSS-->

    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="../../../assets/css/style.css">
    <!-- END: Custom CSS-->

</head>
<!-- END: Head-->

<!-- BEGIN: Body-->

<body class="vertical-layout vertical-menu-modern 2-columns  navbar-floating footer-static  " data-open="click"
    data-menu="vertical-menu-modern" data-col="2-columns">

    <!-- BEGIN: Header-->
    <nav class="header-navbar navbar-expand-lg navbar navbar-with-menu floating-nav navbar-light navbar-shadow">
        <div class="navbar-wrapper">
            <div class="navbar-container content">
                <div class="navbar-collapse" id="navbar-mobile">
                    <div class="mr-auto float-left bookmark-wrapper d-flex align-items-center">

                    </div>
                    <ul class="nav navbar-nav float-right">

                        <li class="nav-item d-none d-lg-block"><a class="nav-link nav-link-expand"><i
                                    class="ficon feather icon-maximize"></i></a></li>


                        <li class="dropdown dropdown-user nav-item"><a
                                class="dropdown-toggle nav-link dropdown-user-link" href="#" data-toggle="dropdown">
                                <div class="user-nav d-sm-flex d-none"><span class="user-name text-bold-600">John
                                        Doe</span><span class="user-status">Available</span></div><span><img
                                        class="round" src="../../../app-assets/images/portrait/small/avatar-s-11.jpg"
                                        alt="avatar" height="40" width="40"></span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right"><a class="dropdown-item"
                                    href="page-user-profile.html"><i class="feather icon-user"></i> Edit Profile</a>

                                <div class="dropdown-divider"></div><a class="dropdown-item" href="auth-login.html"><i
                                        class="feather icon-power"></i> Logout</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>


    <!-- END: Header-->


    <!-- BEGIN: Main Menu-->
    <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow" data-scroll-to-active="true">
        <div class="navbar-header">
            <ul class="nav navbar-nav flex-row">
                <li class="nav-item mr-auto"><a class="navbar-brand"
                        href="../../../html/ltr/vertical-menu-template/index.html">

                        <h2 class="brand-text mb-0">flex frames</h2>
                    </a></li>
                <li class="nav-item nav-toggle"><a class="nav-link modern-nav-toggle pr-0" data-toggle="collapse"><i
                            class="feather icon-x d-block d-xl-none font-medium-4 primary toggle-icon"></i><i
                            class="toggle-icon feather icon-disc font-medium-4 d-none d-xl-block collapse-toggle-icon primary"
                            data-ticon="icon-disc"></i></a></li>
            </ul>
        </div>
        <div class="shadow-bottom"></div>
        <div class="main-menu-content">
            <ul class="navigation navigation-main" id="main-menu-navigation" data-menu="menu-navigation">
                <li class=" nav-item"><a href="index.html"><i class="feather icon-home"></i><span class="menu-title"
                            data-i18n="Dashboard">Dashboard</span></a>
                    <ul class="menu-content">
                        <li class=""><a href="index.html"><i class="feather icon-circle"></i><span
                                    class="menu-item" data-i18n="Analytics">Analytics</span></a>
                        </li>

                    </ul>
                </li>
                <li class=" navigation-header"><span>Pages</span>
                </li>
                <li class=" nav-item"><a href="page-product.html"><i class="feather icon-mail"></i><span
                            class="menu-title" data-i18n="Email">Add Products</span></a>
                </li>
                <li class=" nav-item"><a href="page-showProducts.html"><i class="feather icon-message-square"></i><span
                            class="menu-title">Display Products</span></a>
                        
                            <ul>
                                <li class="active custom-mt">
                                <a href="">
                                    <i class="feather icon-message-square"></i>
                                    <span class="menu-title">Edit Products</span></a>
                            </li>
                            <li class="custom-mt">
                                <a href="page-showProducts.html">
                                    <i class="feather icon-message-square"></i>
                                    <span class="menu-title">See all Products</span></a>
                            </li>
                            </ul>
                </li>
                <li class="nav-item"><a href="collections.html"><i class="feather icon-message-square"></i><span class="menu-title"
                            data-i18n="Chat">Collections</span></a>
                </li>
                <li class=" nav-item"><a href="app-todo.html"><i class="feather icon-check-square"></i><span
                            class="menu-title" data-i18n="Todo">Dispatched</span></a>
                </li>
                <li class=" nav-item"><a href="app-calender.html"><i class="feather icon-calendar"></i><span
                            class="menu-title" data-i18n="Calender">Pending</span></a>
                </li>
                <li class=" nav-item"><a href="app-calender.html"><i class="feather icon-calendar"></i><span
                            class="menu-title" data-i18n="Calender">Account settings</span></a>
                </li>


            </ul>
        </div>
    </div>
    <!-- END: Main Menu-->

    <!-- BEGIN: Content-->
    <div class="app-content content">
        <div class="content-overlay"></div>
        <div class="header-navbar-shadow"></div>
        <div class="content-wrapper">
            <div class="content-header row">
            </div>
            <div class="content-body">
                <!-- users list start -->
                <section class="users-list-wrapper">
    
                    <!-- Add new User -->
                    <div id="basic-examples">
                        <div class="card">
                            <div class="card-content mx-5">
                                <div class="card-body">
                                    <div class="row">
                                <form id="editProductForm" enctype="multipart/form-data">
                                    <label for="title">Title:</label>
                                    <br>
                                    <input class="form-control" type="text" id="edit-title" name="title" required><br>
                                
                                    <label for="description">Description:</label>
                                    <br>
                                    <textarea class="form-control" id="edit-description" name="description" required></textarea><br>
                                
                                    <label for="price">Price:</label>
                                    <br>
                                    <input class="form-control" type="number" id="edit-price" name="price" required><br>

                                    <label for="price">Quantity:</label>
                                    <br>
                                    <input class="form-control" type="number" id="edit-quantity" name="quantity" required><br>
                                    <label for="color">Colors:</label><span><button type="button" class="edit-addColorButton">Add</button></span>
                                    <div id="colorInputs">
                                       
                                    </div>
                                   

                                    <br>
                                    <label for="size">sizes:</label><span><button type="button" class="edit-addSizeButton">Add</button></span>
                                    <div id="sizeInputs">
                                       
                                    </div>
                                    <label for="productImage">Product Image:</label>
                                    <br>
                                    <div class="edit-custom-file">
                                    <input type="file"  class="" id="edit-productImage" name="productImage">
                                    <img id="current-product-image" src="" alt="Current Product Image" >
                                    </div>
                                
                                    <!-- Display the current product image -->
                                    <input class="btn btn-primary mr-1 mt-2 mb-1 waves-effect waves-light" type="submit" value="Edit Product">
                                </form>

                                    </div>
    
                                </div>
                            </div>
                        </div>
                        <!-- Ag Grid users list section end -->
                </section>
                <!-- users list ends -->
    
            </div>
        </div>
    </div>
    <!-- END: Content-->

    <div class="sidenav-overlay"></div>
    <div class="drag-target"></div>

    <!-- BEGIN: Footer-->
    <footer class="footer footer-static footer-light">
        <p class="clearfix blue-grey lighten-2 mb-0"><span
                class="float-md-left d-block d-md-inline-block mt-25">COPYRIGHT &copy; 2023<a
                    class="text-bold-800 grey darken-2" href="https://1.envato.market/pixinvent_portfolio"
                    target="_blank">FlexFrames,</a>All rights Reserved</span><span
                class="float-md-right d-none d-md-block">Hand-crafted & Made with<i
                    class="feather icon-heart pink"></i></span>
            <button class="btn btn-primary btn-icon scroll-top" type="button"><i
                    class="feather icon-arrow-up"></i></button>
        </p>
    </footer>
    <!-- END: Footer-->


    <!-- BEGIN: Vendor JS-->
    <script src="../../../app-assets/vendors/js/vendors.min.js"></script>
    <!-- BEGIN Vendor JS-->

    <!-- BEGIN: Page Vendor JS-->
    <script src="../../../app-assets/vendors/js/charts/apexcharts.min.js"></script>
    <script src="../../../app-assets/vendors/js/extensions/tether.min.js"></script>
    <script src="../../../app-assets/vendors/js/extensions/shepherd.min.js"></script>
    <!-- END: Page Vendor JS-->

    <!-- BEGIN: Theme JS-->
    <script src="../../../app-assets/js/core/app-menu.js"></script>
    <script src="../../../app-assets/js/core/app.js"></script>
    <script src="../../../app-assets/js/scripts/components.js"></script>
    <!-- END: Theme JS-->

    <!-- BEGIN: Page JS-->
    <script src="../../../app-assets/js/scripts/pages/dashboard-analytics.js"></script>
    <!-- END: Page JS-->
    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<!-- Add this script at the end of your HTML file, before </body> tag -->
<script>
    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get('productId');


    // Function to update the image preview
    function updateImagePreview() {
        const input = document.getElementById("edit-productImage");
        const preview = document.getElementById("current-product-image");

        if (input.files && input.files[0]) {
            const reader = new FileReader();

            reader.onload = function (e) {
                preview.src = e.target.result;
            };

            reader.readAsDataURL(input.files[0]);
        } else {
            preview.src = ""; // Clear the preview if no file selected
        }
    }

    // Arrays to store colors and sizes
    const colorsArray = [];
    const sizesArray = [];

    // Fetch product and update form fields
    axios.get(`http://localhost:8000/products/${productId}`)
        .then(function (response) {
            const product = response.data;
            const image = '../../../../../../../backend/' + product.productImagePath
            document.getElementById("edit-title").value = product.title;
            document.getElementById("edit-price").value = product.price;
            document.getElementById("edit-quantity").value = product.quantity;
            document.getElementById("edit-description").value = product.description;
            document.getElementById("current-product-image").src = image;

            // Populate existing colors
            const colorInputs = document.getElementById("colorInputs");
            product.colors.forEach(color => {
                const colorInputDiv = createInputDiv("colors", color);
                colorInputs.appendChild(colorInputDiv);
                colorsArray.push(color);
            });

            // Populate existing sizes
            const sizeInputs = document.getElementById("sizeInputs");
            product.sizes.forEach(size => {
                const sizeInputDiv = createInputDiv("sizes", size);
                sizeInputs.appendChild(sizeInputDiv);
                sizesArray.push(size);
            });
        })
        .catch(function (error) {
            console.log(error)
        });

    // Function to create a dynamic input div
    function createInputDiv(inputName, inputValue) {
        const inputDiv = document.createElement("div");
        inputDiv.innerHTML = `
        <div class = "input-add-remove">
        <input type="text" name="${inputName}" class= "form-control" placeholder="Enter ${inputName}" value="${inputValue}" required>
        <button type="button" class="remove${inputName.charAt(0).toUpperCase() + inputName.slice(1)}Button">Remove ${inputName}</button>
        </div>     `;

        const removeButtonClass = `remove${inputName.charAt(0).toUpperCase() + inputName.slice(1)}Button`;
        const removeButton = inputDiv.querySelector(`.${removeButtonClass}`);
        removeButton.addEventListener("click", () => {
            inputDiv.parentNode.removeChild(inputDiv);
            if (inputName === "colors") {
                const index = colorsArray.indexOf(inputValue);
                if (index !== -1) {
                    colorsArray.splice(index, 1);
                }
            }
            if (inputName === "sizes") {
                const index = sizesArray.indexOf(inputValue);
                if (index !== -1) {
                    sizesArray.splice(index, 1);
                }
            }
        });

        return inputDiv;
    }

    // Add Color button
    const addColorButton = document.querySelector(".edit-addColorButton");
    const colorInputs = document.getElementById("colorInputs");

    addColorButton.addEventListener("click", () => {
        const colorInputDiv = createInputDiv("colors", "");
        colorInputs.appendChild(colorInputDiv);
        colorsArray.push(""); 
    });


    const addSizeButton = document.querySelector(".edit-addSizeButton");
    const sizeInputs = document.getElementById("sizeInputs");

    addSizeButton.addEventListener("click", () => {
        const sizeInputDiv = createInputDiv("sizes", "");
        sizeInputs.appendChild(sizeInputDiv);
        sizesArray.push(""); 
    });

    const editProductForm = document.getElementById("editProductForm");
    const editProductImageInput = document.getElementById("edit-productImage");

    editProductImageInput.addEventListener("change", function () {
        updateImagePreview();
    });

    editProductForm.addEventListener("submit", function (e) {
        e.preventDefault();

        const formData = new FormData();
        formData.append("title", document.getElementById("edit-title").value);
        formData.append("description", document.getElementById("edit-description").value);
        formData.append("price", document.getElementById("edit-price").value);
        formData.append("quantity", document.getElementById("edit-quantity").value);

      
        colorsArray.forEach(color => {
            formData.append("colors", color);
        });
        sizesArray.forEach(size => {
            formData.append("sizes", size);
        });

  
        if (editProductImageInput.files[0]) {
            formData.append("productImage", editProductImageInput.files[0]);
        }

        axios.put(`http://localhost:8000/products/${productId}`, formData, {
            headers: {
                "Content-Type": "multipart/form-data", // Set the content type
            },
        })
            .then(function (response) {
                console.log(response.data);
                window.location.href = "page-showProducts.html";
            })
            .catch(function (error) {
                console.error(error);
            });
    });


</script>

</body>
<!-- END: Body-->

</html>